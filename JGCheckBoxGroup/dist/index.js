!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";isc.ClassFactory.defineClass("JGCheckBoxGroup","JGGroupItem"),isc.ClassFactory.mixInInterface("JGCheckBoxGroup","IWindowAop"),isc.addGlobal("JGCheckBoxGroup",isc.JGCheckBoxGroup),isc.JGCheckBoxGroup.addProperties({TableName:"",WidgetStyle:"JGBoxGroup"}),isc.JGCheckBoxGroup.addMethods({_initProperties:function(e){this.TitleTextAlign=e.TitleTextAlign=e.LabelTextAlign,this.TitleVisible=e.TitleVisible=e.LabelVisible,this.TitleWidth=e.TitleWidth=e.LabelWidth,this.type="checkBoxGroup",this.multiple=!0,this.AutoWrap=!1,this.textField="",this.valueField="",e.ColumnName?this.textField=e.ColumnName:(this.textField="ColumnName",this.ColumnName="ColumnName"),e.IDColumnName?this.valueField=e.IDColumnName:(this.IDColumnName="IDColumnName",this.valueField="IDColumnName"),e.TabIndex>=2&&(this.TabIndex=e.TabIndex-2),this.NumCols=1,this.className+=" JGCheckBoxGroup";var t=this;this.items=[isc.addProperties(e,{type:"V3CheckBoxGroupItems",isAbsoluteForm:!0,getData:function(){return t.getDropDownSource()}})],this._initEventAndDataBinding(),this._observerDropdownSource()},_initEventAndDataBinding:function(){var e=this;isc.WidgetDatasource.addBindDatasourceCurrentRecordUpdateEventHandler(this,null,null,(function(t){isc.DataBindingUtil.setWidgetValue(e,t),e.hasErrors()&&e.values&&e.values[e.IDColumnName]&&""!=e.values[e.IDColumnName]&&(e.clearErrors(),e.redraw())})),isc.WidgetDatasource.addBindDatasourceCurrentRecordClearEventHandler(this,null,null,(function(){isc.DataBindingUtil.clearWidgetValue(e),e.hasErrors()&&e.values&&e.values[e.IDColumnName]&&""!=e.values[e.IDColumnName]&&(e.clearErrors(),e.redraw())})),isc.DatasourceUtil.addDatasourceLoadEventHandler(this,this.OnValueLoaded),isc.DatasourceUtil.addDatasourceFieldUpdateEventHandler(this,[this.IDColumnName],this.OnValueChanged)},_observerDropdownSource:function(){var e=this.getDropDownSource();if("object"!=typeof e)try{e=isc.JSON.decode(e)}catch(e){}if(e&&e.DataSourceSetting&&"Entity"==e.DataSourceSetting.DataSourceType){var t=e.DataSourceSetting.DataConfig.SourceName;if(t){var a=isc.JGDataSourceManager.get(this,t);if(a){var i=this;a.on(a.Events.LOAD,null,(function(){i.dropdownSourceHandler()})),a.on(a.Events.INSERT,null,(function(){i.dropdownSourceHandler()})),a.on(a.Events.DELETE,null,(function(){i.dropdownSourceHandler()}))}}}},getBindFields:function(){return[this.IDColumnName,this.ColumnName]},filterChanged:function(e){return e&&e.hasOwnProperty(this.IDColumnName)},beforeDataLoad:function(){this.BeforeDataLoadAction&&this.BeforeDataLoadAction()},getDropDownSource:function(){return this.DropDownSource},setDropDownSource:function(e){this.DropDownSource=e},getIDColumnName:function(){return this.IDColumnName},getColumnName:function(){return this.ColumnName},getV3Value:function(){var e=isc.WidgetDatasource.getSingleValue(this,this.IDColumnName);return null==e||null==e?"":e},setV3Value:function(e){var t={};t[this.IDColumnName]=e,isc.WidgetDatasource.setSingleRecordMultiValue(this,t)},getSelectedItmesNum:function(){return this.values[this.IDColumnName]?this.SelectedItmesNum=this.values[this.IDColumnName].length:this.values.IDColumnName?this.SelectedItmesNum=this.values.IDColumnName.length:this.SelectedItmesNum=0,this.SelectedItmesNum},_getDefaultValue:function(){var e={},t=null,a=null;if(o=this.DropDownSource){if("object"!=typeof o)try{o=isc.JSON.decode(o)}catch(e){}var i=o.uiData;if(i)for(var n=0;n<i.length;n++){var o;if(1==(o=i[n]).default){t=o.id,a=o.text;break}}e[this.IDColumnName]=t,e[this.ColumnName]=a}return e},getDefaultValue:function(){return this._getDefaultValue()},getConstData:function(e){var t,a=e.DataConfig;if(a)switch(e.DataSourceType){case"Entity":a.EntityConstData&&(t=a.EntityConstData.ConstData);break;case"TableQuery":a.SqlQueryConstData&&(t=a.EntityConstData.ConstData);break;case"CustomConst":a&&(t=a.ConstData)}return t},setDefaultRecord:function(){var e=this._getDefaultValue();e&&isc.WidgetDatasource.setSingleRecordMultiValue(e)},getText:function(){return isc.WidgetDatasource.getDatasource(this).getCurrentRecord()[this.ColumnName]},getV3MethodMap:function(){return{getValue:"getV3Value",setValue:"setV3Value"}}})}));
